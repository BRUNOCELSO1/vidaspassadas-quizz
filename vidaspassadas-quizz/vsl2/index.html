<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VSL 2 — Vídeo de 29:19</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --brand-green: #19a10b; --text-light: #ffffff; }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: "Sora", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color: var(--text-light); background: #000;
      background-image: url('../img/vidaspassadas.3c30e61f.webp');
      background-size: cover; background-position: center; background-repeat: no-repeat;
    }
    .page-wrap { min-height: 100%; display: grid; place-items: center; padding: 24px; background: transparent; position: relative; }
    .page-wrap::before { content: ""; position: fixed; inset: 0; background: rgba(0,0,0,0.65); pointer-events: none; z-index: 0; }
    .page-wrap > * { position: relative; z-index: 1; }
    .panel { width: min(980px, 96vw); border: none; border-radius: 12px; background: transparent; box-shadow: 0 10px 40px rgba(0,0,0,.0); padding: clamp(16px, 3vw, 40px); display: flex; flex-direction: column; align-items: center; text-align: center; gap: 8px; }
    .player-mount { width: 100%; max-width: 960px; margin: 8px auto 0; border-radius: 12px; overflow: hidden; box-shadow: 0 6px 18px rgba(0,0,0,.25); position: relative; isolation: isolate; background: #000; }
    .vt-iframe-wrap, .vt-next-wrap { position: relative; width: 100%; background: #000; }
    @supports (aspect-ratio: 9/16) {
      .vt-iframe-wrap, .vt-next-wrap { aspect-ratio: 9/16; height: auto; }
      .vt-iframe-wrap[style], .vt-next-wrap[style] { padding-top: 0 !important; }
    }
    @supports not (aspect-ratio: 9/16) { .vt-iframe-wrap, .vt-next-wrap { padding-top: 177.78%; } }
    .vt-iframe-wrap iframe, .vt-next-wrap iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; display: block; }

    /* Botão overlay posicionado dentro da área do player (mesmo padrão da VSL1) */
    .vt-overlay-btn { position: absolute; z-index: 9999; pointer-events: auto; opacity: 0.98; left: 50%; bottom: 12%; transform: translateX(-50%); will-change: transform; }
    @media (max-width: 767px) { .vt-overlay-btn { bottom: calc(14% + env(safe-area-inset-bottom)); transform: translateX(-50%); } }

    /* Botão COMPRAR AGORA verde pulsante */
    .cta-buy {
      margin-top: 0px;
      display: inline-grid;
      place-items: center;
      padding: 12px 22px;
      background: var(--brand-green);
      color: #fff;
      border: none;
      border-radius: 999px;
      font-weight: 800;
      font-size: clamp(15px, 1.8vw, 20px);
      letter-spacing: .06em;
      cursor: pointer;
      text-transform: uppercase;
      user-select: none;
      animation: pulseGreen 1.3s infinite ease-in-out;
      box-shadow: 0 0 0 rgba(25,161,11,0.7);
    }
    .cta-buy:hover { filter: brightness(1.05); }

    @keyframes pulseGreen {
      0% { transform: translateX(-50%) scale(1); box-shadow: 0 0 0 0 rgba(25,161,11,0.7); }
      70% { transform: translateX(-50%) scale(1.03); box-shadow: 0 0 0 12px rgba(25,161,11,0); }
      100% { transform: translateX(-50%) scale(1); box-shadow: 0 0 0 0 rgba(25,161,11,0); }
    }

    /* Mobile fix: largura total e sem bordas */
    @media (max-width: 767px) {
      html, body { height: auto; overflow-x: hidden; }
      .page-wrap { padding: 0; }
      .panel { width: 100vw; max-width: 100vw; margin: 0; padding: 0; border-radius: 0; box-shadow: none; }
      .player-mount { width: 100vw !important; max-width: 100vw !important; margin: 0 !important; border-radius: 0 !important; box-shadow: none !important; }
      .vt-iframe-wrap, .vt-next-wrap { width: 100vw !important; max-width: 100vw !important; aspect-ratio: 9/16; height: 100svh; height: 100dvh; height: 100vh; }
      .vt-iframe-wrap[style], .vt-next-wrap[style] { padding-top: 0 !important; }
      .vt-iframe-wrap iframe, .vt-next-wrap iframe { width: 100% !important; height: 100% !important; }
    }
  </style>
  <!-- Google Analytics 4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-11R9QPX4PW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-11R9QPX4PW');
  </script>
  <script>
    // Helpers de eventos seguros
    window.gaEvent = function(name, params){ try { if (typeof gtag === 'function') gtag('event', name, params || {}); } catch(e){} };
    window.fbEvent = function(name, params){ try { if (typeof fbq === 'function') { if (name === 'Lead' || name === 'InitiateCheckout' || name === 'PageView' || name === 'ViewContent') fbq('track', name, params || {}); else fbq('trackCustom', name, params || {}); } } catch(e){} };
  </script>
   <!-- Facebook Pixel Code -->
   <script>
 !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
 n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
 n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
 t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}
 (window, document,'script','https://connect.facebook.net/en_US/fbevents.js');
 fbq('init', '548423381240354');
 fbq('track', 'PageView');
 fbq('track', 'ViewContent', { content_name: 'VSL2' });
   </script>
   <noscript>
     <img height="1" width="1" style="display:none"
          src="https://www.facebook.com/tr?id=548423381240354&ev=PageView&noscript=1"/>
   </noscript>
   <!-- End Facebook Pixel Code -->
</head>
<body>
  <div class="page-wrap">
    <div class="panel" role="dialog" aria-labelledby="headline">
      <!-- Player: SEGUNDO vídeo (29:19) -->
      <div class="player-mount">
        <div class="vt-iframe-wrap vt-next-wrap" style="position:relative;width:100vw;height:100svh;height:100dvh;height:100vh;padding-top:0">
          <iframe src="https://scripts.converteai.net/53b24e03-a5a0-4eb4-899f-91ca4a329ef7/players/68f95fa87e181d1f6b410a35/v4/embed.html" allow="autoplay; fullscreen" referrerpolicy="no-referrer-when-downgrade" scrolling="no" frameborder="0" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0;display:block"></iframe>
          <!-- VTurb: preload e DNS-prefetch dentro do container (após CONTINUAR) -->
          <link rel="preload" href="https://scripts.converteai.net/53b24e03-a5a0-4eb4-899f-91ca4a329ef7/players/68f95fa87e181d1f6b410a35/v4/embed.html">
          <script>!function(i,n){i._plt=i._plt||(n&&n.timeOrigin?n.timeOrigin+n.now():Date.now())}(window,performance);</script>
          <link rel="preload" href="https://scripts.converteai.net/53b24e03-a5a0-4eb4-899f-91ca4a329ef7/players/68f95fa87e181d1f6b410a35/v4/player.js" as="script">
          <link rel="preload" href="https://scripts.converteai.net/lib/js/smartplayer-wc/v4/smartplayer.js" as="script">
          <link rel="preload" href="https://cdn.converteai.net/53b24e03-a5a0-4eb4-899f-91ca4a329ef7/68f95ed72dd382284f41b751/main.m3u8" as="fetch">
          <link rel="dns-prefetch" href="https://cdn.converteai.net">
          <link rel="dns-prefetch" href="https://scripts.converteai.net">
          <link rel="dns-prefetch" href="https://images.converteai.net">
          <link rel="dns-prefetch" href="https://api.vturb.com.br">
        </div>
      </div>
    </div>
  </div>

  <script>
    (function(){
      var mount = document.querySelector('.vt-iframe-wrap.vt-next-wrap') || document.querySelector('.vt-iframe-wrap');
      if (!mount) return;
      var iframe = mount.querySelector('iframe');
      try { window.__nextIframeEl = iframe; } catch(_){}
      // Marca player 2 injetado (útil para sanity-check no GA4/FB)
      try {
        window.gaEvent && gaEvent('vsl_player_injected', { video: 'vsl2' });
        window.fbEvent && fbEvent('VSL2PlayerInjected');
      } catch(_){}
   
      function ensureBuyBtn(){
        var btn = document.getElementById('buyNowBg');
        if (!btn) {
          var mountEl = document.querySelector('.vt-iframe-wrap.vt-next-wrap') || document.querySelector('.vt-iframe-wrap');
          if (mountEl) {
            btn = document.createElement('a');
            btn.id = 'buyNowBg';
            btn.className = 'cta-buy vt-overlay-btn';
            btn.hidden = true;
            btn.href = '#';
            btn.textContent = 'COMPRAR AGORA';
            mountEl.appendChild(btn);
          }
        }
        if (!btn) return null;
        if (!btn.__binded) {
          btn.__binded = true;
          btn.setAttribute('role','button');
          btn.setAttribute('aria-label','Comprar agora');
          btn.addEventListener('click', function(ev){
            ev.preventDefault();
            try { gaEvent('begin_checkout', { origin: 'vsl2' }); } catch(e){}
            try { fbEvent('InitiateCheckout'); } catch(e){}
            try {
              var url = new URL('https://pay.hotmart.com/P97512235D?off=bq5vcwru');
              var sp = new URLSearchParams(window.location.search || '');
              sp.forEach(function(v,k){ try { url.searchParams.set(k,v); } catch(_){} });
              window.location.href = url.toString();
            } catch(_){ window.location.href = 'https://pay.hotmart.com/P97512235D?off=bq5vcwru'; }
          });
        }
        return btn;
      }

      function showBuyNow(){
        try {
          var btn = ensureBuyBtn();
          btn.hidden = false;
          btn.style.display = 'inline-grid';
          btn.style.visibility = 'visible';
          btn.style.opacity = '1';
          btn.style.pointerEvents = 'auto';
          try { gaEvent('vsl_buy_shown', { page: 'vsl2' }); } catch(e){}
          try { fbEvent('VSLBuyShown'); } catch(e){}
        } catch(_){}
      }
      // Captura cliques em um possível botão de overlay do player (diferente do nosso #buyNowBg)
      document.addEventListener('click', function(ev){
        var el = ev.target && ev.target.closest ? ev.target.closest('.vt-overlay-btn') : null;
        if (!el) return;
        if (el.id === 'buyNowBg') return; // já tratamos acima
        try { gaEvent('begin_checkout', { origin: 'vsl2_overlay' }); } catch(e){}
        try { fbEvent('InitiateCheckout'); } catch(e){}
      }, true);

      var BUY_AT = 1113; // 18min 33s
      try {
        var qs = new URLSearchParams(location.search || '');
        var overrideBuy = parseFloat(qs.get('buyAt') || '');
        if (isFinite(overrideBuy)) BUY_AT = overrideBuy;
      } catch(_){}
 
       function toSecondsAny(x){
        if (x == null) return NaN;
        if (typeof x === 'number') return isFinite(x) ? x : NaN;
        if (typeof x === 'string') {
          var s = x.trim();
          if (/^\d+(?:\.\d+)?$/.test(s)) return parseFloat(s);
          var m = s.match(/^(\d{1,2}):([0-5]?\d)(?::([0-5]?\d))?$/);
          if (m) {
            var h = m[3] ? parseInt(m[1],10) : 0;
            var mm = m[3] ? parseInt(m[2],10) : parseInt(m[1],10);
            var ss = m[3] ? parseInt(m[3],10) : parseInt(m[2],10);
            return (h*3600) + (mm*60) + ss;
          }
          var mt = s.match(/(?:currentTime|time|seconds|position)\s*[:=]\s*(\d+(?:\.\d+)?)/i);
          if (mt) return parseFloat(mt[1]);
        }
        return NaN;
      }

      function pickTimeFrom(obj){
        if (!obj || typeof obj !== 'object') return NaN;
        var keys = ['currentTime','time','seconds','position'];
        for (var i=0; i<keys.length; i++) {
          var v = obj[keys[i]];
          var t = toSecondsAny(v);
          if (isFinite(t)) return t;
        }
        var nest = obj.data || obj.payload || obj.detail || obj.message || null;
        if (nest && typeof nest === 'object') return pickTimeFrom(nest);
        return NaN;
      }

      function onMessage(e){
        try {
          var d = e.data;
          var tSec = NaN;
          if (d && typeof d === 'object') tSec = pickTimeFrom(d);
          else if (typeof d === 'string') tSec = toSecondsAny(d);
          var fromThis = false;
          try { if (iframe && iframe.contentWindow) { fromThis = (e.source === iframe.contentWindow); } } catch(_){}
          if (fromThis && isFinite(tSec) && tSec >= BUY_AT && !window.__buyShown) {
            window.__buyShown = true;
            showBuyNow();
          }
        } catch(err) {
          try { console.warn('[VSL2] onMessage parse error:', err); } catch(_){}
        }
      }
      window.addEventListener('message', onMessage, false);

      // Modo de teste para validar botão
      try {
        var qs2 = new URLSearchParams(location.search || '');
        if (qs2.get('showBuyStart') === '1') { showBuyNow(); }
        var buyDelayMsRaw = qs2.get('buyDelayMs');
        if (buyDelayMsRaw != null) {
          var buyDelayMs = parseInt(String(buyDelayMsRaw), 10);
          if (!isNaN(buyDelayMs) && buyDelayMs >= 0) {
            setTimeout(function(){ try { showBuyNow(); } catch(_){} }, buyDelayMs);
          }
        }
      } catch(_){}
    })();
  </script>
</body>
</html>
